<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>E2E Testing with Protractor</title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link href='http://fonts.googleapis.com/css?family=Ubuntu:300,400,500,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/enterjs.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
      if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
      }
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>
  <a style="font-family: 'Ubuntu', sans-serif; color: #CCC; text-decoration: none; font-size: 1.5em;position: absolute; top: 1em; left: 1em; z-index: 2;" href="http://www.enterjs.de/abstracts#e2e-testing-mit-protractor"><img height="50" style="box-shadow: 0 0 0 1px #000; border-radius: 0.1em;"src="img/enterjs-logo.png"><span style="vertical-align: 80%; color: #fff; border-radius: 0.3em; padding: 0.3em; font-size: 0.8em; background-color: #2c2c2c; display: inline-block; margin-left: 0.3em;">#ejs14</span></a>

  <p style="position: absolute; bottom: 2em; left: 1em; font-family: 'Ubuntu'; font-size: 0.9em; color: #A0A0A0;">E2E Testing with Protractor by @PascalPrecht</p>
    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <section>
          <h2 style="font-size: 3em; margin-top: 0.8em;">E2E Testing</h2>
          <h3 style="margin-top: 0.5em;margin-bottom: 0;">with</h3>
          <img style="margin: 0.5em 0 0 0;" src="img/protractor-logo.png" width="600">
          <p style="margin-bottom: 0; margin-top: 3em; font-size: 0.8em;">
            By <a href="http://github.com/PascalPrecht">Pascal Precht</a> / <a href="http://twitter.com/PascalPrecht">@PascalPrecht</a>
          </p>
          <p style="font-size: 0.6em; margin-top: 0.5em;">enterJS - July 1, 2014</p>
        </section>

        <section data-background="img/stickers.jpg">
        </section>
        <section>
          <h2 style="text-align: left; margin-top: 0em;">Hi, I'm Pascal.</h2>
          <h4 style="text-align: left;">Front-end Engineer</h4>
          <p style="font-size: 0.8em;text-align: left; margin-top: 2em;">I work at <a href="http://couchcommerce.com">CouchCommerce</a></p>
          <p style="font-size: 0.8em; text-align: left;">Teach people at <a href="http://thoughtram.io">thoughtram</a></p>
          <p style="font-size: 0.8em;text-align: left;"><a href="http://twitter.com/PascalPrecht">@PascalPrecht</a> on Twitter and GitHub</p>
          <p style="font-size: 0.8em;text-align: left;">Creator of <a href="http://twitter.com/PascalPrecht">angular-translate</a></p>
          <p style="font-size: 0.8em;text-align: left;"><span style="color: red;">&hearts;</span> animated gifs</p>
          <div style="position: absolute; top: 0; right: 0;">
            <img style="border-radius: 50%; border: solid 5px #7C2!important;" height="400" src="img/pascal.png">
          </div>
        </section>

        <section>
          <h2>My mission today...</h2>
        </section>

        <section data-background="img/mind-blown.gif">
        </section>

        <section data-background="img/ohhh-minion.gif">
        </section>

        <section>
          <h2>Why people don't test</h2>
          <ul>
            <li class="fragment">Missing expertise (How to test? Which tool to use?)</li>
            <li class="fragment">Takes too long (environment setup etc.)</li>
            <li class="fragment">works-for-meâ„¢ (and without tests)</li>
            <li class="fragment">...</li>
          </ul>
        </section>

        <section>
          <h2>Why people should test</h2>
          <ul>
            <li class="fragment">Verifies that system meets requirements</li>
            <li class="fragment">Improves quality (code and product)</li>
            <li class="fragment">Helps to *not* deploy bugs</li>
            <li class="fragment">Makes debugging easier</li>
            <li class="fragment">...</li>
          </ul>
        </section>

        <section>
          <h2>What we're gonna cover</h2>

          <ul>
            <li class="fragment">E2E Tests? (What, Why, When)</li>
            <li class="fragment">Protractor as an E2E Testing framework</li>
            <li class="fragment">Architecture</li>
            <li class="fragment">E2E Tests with Protractor</li>
            <li class="fragment">Protractor tests compared to vanilla WebdriverJS tests</li>
            <li class="fragment">...</li>
          </ul>
        </section>

        <section>
          <p style="font-size: 1.5em; line-height: 1.8;">So next time you deploy an app, you don't feel like this...</p>
        </section>

        <section data-background="img/girls-swing.gif">
        </section>

        <section>
          <p style="font-size: 1.5em; line-height: 1.6;">But rather like this...</p>
        </section>

        <section data-background="img/smooth.gif">
        </section>

        <section>
          <h1 style="font-size: 2.8em;">E2E Testing</h1>
        </section>

        <!-- <section> -->
        <!--   <img width="600" src="img/no-e2e.png"> -->
        <!-- </section> -->

        <section>
          <h2>What?</h2>
          <ul>
            <li class="fragment">Ensures pieces work together</li>
            <li class="fragment">Checks if app performs as designed from start to finish</li>
            <li class="fragment">Tests user interaction/usability</li>
          </ul>
        </section>

        <section>
          <h2>Why?</h2>
          <p style="margin-top: 1em;">Well... imagine you have to do the following things by hand to test your app:</p>
          <ul>
            <li class="fragment">Click every link in your app</li>
            <li class="fragment">Check if form validation works (in all forms!)</li>
            <li class="fragment">Count items in your search result when using a search bar</li>
            <li class="fragment">Make screenshots of different states</li>
            <li class="fragment">...</li>
          </ul>
        </section>

        <section data-background="img/make-it-stop.gif">
        </section>

        <section>
          <h2>When?</h2>
          <ul>
            <li class="fragment">Once components are unit tested</li>
            <li class="fragment">Before app deploy</li>
          </ul>
        </section>

        <section data-background="img/so-what.gif">
          <p class="fragment" style="margin-top: 5em; text-align: right; color: #fff; font-size: 1.5em; line-height: 1.6">Alright, tell us.<br>What's this Protractor-thingy?</p>
        </section>
        <section>
          <p style="font-size: 1.2em; line-height: 1.6;">Protractor is an E2E testing framework built on top of Webdriver to make E2E testing for AngularJS applications more fun.</p>
          <div style="position: absolute; right: -3em; bottom: -3em; ">
            <img style="-webkit-transform: rotateZ(-14deg);" width="500" src="img/protractor-logo.png">
          </div>

        </section>

        <section>
          <h2>Key Features</h2>

          <ul>
            <li class="fragment">Built on top of Webdriver</li>
            <li class="fragment">Syntactic Sugar for AngularJS Apps (Locator Strategies)</li>
            <li class="fragment">Able to run tests on a remote (Selenium) server</li>
            <li class="fragment">Run tests in different browsers</li>
          </li>
        </section>

        <section>
          <h2 style="line-height: 1.2;">Why not just Webdriver?</h2>
          <p class="fragment" style="margin-top: 1em;">AngularJS gives structure to an app your runner can use:</p>
          <ul style="margin-top: 1em;">
            <li class="fragment">Custom attributes and elements</li>
            <li class="fragment">Dependency Injection</li>
            <li class="fragment">Asynchronous execution (e.g. $http, $timeout)</li>
          </ul>
        </section>

        <section>
          <h2>Design</h2>
          <img style="margin-top: 0; margin-bottom: 0; width: 800px;" class="fragment" src="img/protractor-design.png">
        </section>

        <section data-background="img/house-bored.gif">
          <h1 class="fragment" style="color: #fff;">Demo</h1>
        </section>

        <section>
          <p style="font-size: 1.2em; line-height: 1.6">Okay, lets see how Protractor actually helps us.</p>
        </section>

        <section>
          <section>
            <h2>Configuration</h2>
          </section>
          <section>
            <h2>Configure Protractor</h2>
            <pre style="font-size: 0.7em; margin-top: 2em;"><code>exports.config = {

  seleniumAddress: 'http://localhost:4444/wd/hub',

  capabilities: {
    'browserName': 'chrome'
  },

  baseUrl: 'http://localhost:9000',

  onPrepare: function () {
    // do something before running tests
  },

  specs: ['glob/pattern/**/*.spec.js']
  ...
}</code></pre>
          
          </section>
        </section>

        <section>
          <section>
            <h2 style="font-size: 1.8">Writing tests</h2>
          </section>
          <section>
            <h2 style="font-size: 1.8em;">Writing tests with WebdriverJS</h2>
            <pre style="font-size: 0.7em; margin-top: 2em;"><code>var wd = require('selenium-webdriver');

var driver = new wd.Builder()
  .withCapabilities(wd.Capabilities.chrome())
  .build();

driver.get('http://google.com');
driver.findElement(wd.By.name('q')).sendKeys('webdriver');
driver.findElement(wd.By.name('btnG')).click();
driver.wait(function () {
  return driver.getTitle().then(function (title) {
    retun title === 'webdriver - Google Search';
  });
});</code></pre>

            <p style="margin-top: 1em;">Also handles control flow</p>
          </section>

          <section>
            <h2 style="font-size: 1.8em;">Writing tests with Protractor</h2>
            <pre style="font-size: 0.7em; margin-top: 2em;"><code>describe('something', function () {
  beforeEach(function () {
    browser.get('some/url');
  });

  it('should do something', function () {
    var foo = element(by.className('foo'));
    expect(foo.isDisplayed()).toBe(true);
  });

  it('should do something', function () {
    element(by.input('search')).sendKeys('bar');
    element(by.buttonText('submit'));
    expect(element(by.className('search-result')).isDisplayed())
      .toBe(true);
  });
});</code></pre>

          </section>

          <section>
            <h2 style="font-size: 1.8em;">Global variables in Protractor</h2>
            <ul>
              <li class="fragment"><code>browser</code> - Actual Webdriver wrapper</li>
              <li class="fragment"><code>by</code> - <code>WebdriverBy</code> wrapper</li>
              <li class="fragment"><code>element</code> - <code>ElementFinder</code> and <code>ElementArrayFinder</code></li>
              <li class="fragment"><code>$</code> - <code>browser.$</code> shorthand (wraps <code>element</code>)</li>
              <li class="fragment"><code>$$</code> - <code>browser.$$</code> shorthand (wraps <code>element.all</code>)</li>
              <li class="fragment"><code>protractor</code> - Protractor instance</li>
            </ul>
          </section>
        </section>

        <section>
          <section>
            <h2>Finding elements</h2>
          </section>

          <section>
            <h2 style="font-size: 1.4em;"><code>element()</code> and <code>element.all()</code></h2>

            <div class="fragment">
              <p style="margin-top: 2em; "><code>element(locator)</code> returns a single <code>WebElement</code>:</p>
              <pre style="font-size: 0.7em; margin-top: 1em;"><code>element(by.binding('search')).isPresent();
element(by.binding('search')).click();</code></pre>
            </div>
            <div class="fragment">
              <p style="margin-top: 1.5em; "><code>element.all(locator)</code> returns a collection of <code>WebElements</code>:</p>
              <pre style="font-size: 0.7em; margin-top: 1em;"><code>element.all(by.className('fancy-button')).get(0).click();
element.all(by.className('fancy-button')).each(function (button) {
  // do something with button
});</code></pre>
            </div>

          </section>
        </section>
        <section>
          <section>
            <h2>Locator Strategies</h2>
          </section>

          <section>
            <h2 style="margin-top: -4em; font-size: 1.8em;">WebDriverJS Locators</h2>

            <ul class="wd-locator-strategies">
              <li class="fragment" style="position: absolute; left: 0; top: -4em;"><code>webdriver.By.className</code></li>
              <li class="fragment" style="font-size: 1.4em;position: absolute; right: 5em; top: 0em;"><code>webdriver.By.css</code></li>
              <li class="fragment" style="position: absolute; left: 3em; top: 6em;"><code>webdriver.By.id</code></li>
              <li class="fragment" style="position: absolute; left: -3em; top: -1.5em;"><code>webdriver.By.js</code></li>
              <li class="fragment" style="position: absolute; right: -1em; top: -2em;"><code>webdriver.By.linkText</code></li>
              <li class="fragment" style="position: absolute; top: 2.5em;"><code>webdriver.By.partialLinkText</code></li>
              <li class="fragment" style="top: 3em; left: -1em; position: absolute;"><code>webdriver.By.tagName</code></li>
              <li class="fragment" style="top: 5em; right: 1em; position: absolute;"><code>webdriver.By.xpath</code></li>
            </ul>
          </section>
          <section>
            <h2 style="font-size: 1.8em;" >Protractor Locators</h2>
            <table class="locator-strategies fragment">
              <tr>
                <th>HTML</th>
                <th>Locator</th>
              </tr>
              <tr>
                <td><code>&lt;span&gt;{{yourName}}&lt;/span&gt;</code></td>
                <td><code>element(by.binding('yourName'));</code></td>
              </tr>
              <tr>
                <td><code>&lt;input ng-model="password"&gt;</code></td>
                <td><code>element(by.input('password'));</code></td>
              </tr>
              <tr>
                <td><code>&lt;tr ng-repeat="foo in foos"&gt;</code></td>
                <td><code>
                    element(by.repeater('foo in foos'))
                      .row(1)
                      </code>
                    <code style="margin-top: 0.5em; display: inline-block;">
                    element(by.repeater('foo in foos'))
                      .column('foo.bar');
                      </code>
                </td>
              </tr>
              <tr>
                <td><code>&lt;li class="pet"&gt;Dog&lt;/li&gt;</code></td>
                <td><code>element(by.cssContainingText('.pet', 'Dog'));</code></td>
              </tr>
            </table>
          </section>
        </section>

        <section style="position: relative;">
          <p style="font-size: 1.2em;">Isn't it a pain to write these over and over again?</p>
          <h4 class="job-title fragment current-visible">YES!</h4>
        </section>
        <section>
          <section>
            <h2>Page Objects to the rescue!</h2>
          </section>
          <section>
            <h2>Page Objects</h2>
            <ul style="margin-top: 1em;">
              <li>A pattern to encapsulate parts of app logic</li>
              <li class="fragment">Makes repetitive tasks reusable</li>
              <li class="fragment">Improves readability of your tests</li>
            </ul>
          </section>

          <section>
            <h2>Page Object Definition</h2>
            <pre class="fragment" style="font-size: 0.7em; margin-top: 2em;"><code style="max-height: 450px;">var LoginPage = function () {

    this.usernameInput = function () {
      return element(by.css('.username-input'));
    };

    this.passwordInput = function () {
      return element(by.css('.password-input'));
    };

    this.loginButton = function () {
      return element(by.css('.login-button'));
    };

    this.login = function (username, password) {
      this.usernameInput().sendKeys(username);
      this.passwordInput().sendKeys(password);
      this.loginButton().click();
    };
};
            
module.exports = new LoginPage();</code></pre>
          </section>
          
          <section>
            <h2>Usage</h2>
            <pre class="fragment" style="font-size: 0.7em; margin-top: 2em;"><code style="max-height: 450px;">var LoginPage = require('./loginPage.js');

it('should do something', function () {
  LoginPage.usernameInput().sendKeys('username');
  LoginPage.passwordInput().sendKeys('secret');
  LoginPage.loginButton().click();
  ...
});

it('should do something', function () {
  LoginPage.login('Pascal', 'idonttellya');
  ...
});
</code></pre>

          </section>
        </section>

        <section>
          <h2>What if I get stuck?</h2>
        </section>

        <section>
          <section>
            <h2 style="font-size: 3em;">Let's debug!</h2>
          </section>

          <section>
            <h2>Pausing to debug</h2>
          <pre class="fragment" style="font-size: 0.7em; margin-top: 2em;"><code>it('should do something', function () {
  browser.get('some/url');

  // set debugger before failing expectation
  browser.debugger();

  expect(thisWillFail).toBe(true);
});
</code></pre>
          <pre class="fragment" style="font-size: 0.7em; margin-top: 1em;"><code>$ protractor debug protractor.conf.js
</code></pre>
          <p style="margin-top: 1em;" class="fragment">Also inserts <code>window.clientSideScripts</code> into the browser</p>
          </section>

          <section>
            <h2>Interactive element explorer</h2>
            <pre class="fragment" style="font-size: 0.7em; margin-top: 2em;"><code>$ ./bin/elementexplorer.js http://some-url.com</code></pre>
            <pre class="fragment" style="font-size: 0.7em; margin-top: 2em;"><code>&gt; element(by.id('foo')).getText()</code></pre>
            <pre class="fragment" style="font-size: 0.7em; margin-top: 2em;"><code>&gt; browser.get('http://enterjs.de');</code></pre>
          </section>
        </section>

        <section>
          <section>
            <h2>Taking screenshots</h2>
            <p style="margin-top: 1.8em;">Yes, even *that* is possible</p>
          </section>

          <section>
            <p style="font-size: 1.2em;"><code>browser.takeScreenshot()</code> makes taking screenshots a breeze.</p>
            <pre class="fragment" style="font-size: 0.7em; margin-top: 1em;"><code>var fs = require('fs');

function writeScreenshot(data, filename) {
  var stream = fs.createWriteStream(filename);

  stream.write(new Buffer(data, 'base64');
  stream.end();
}

it('should do something', function () {

  browser.takeScreenshot().then(function (png) {
    writeScreenshot(png, 'screenshot.png');
  });
});
</code></pre>
          </section>
        </section>
        <section>
          <h2 style="font-size: 3em;">Demo</h2>
        </section>

        <section data-background="img/applause.gif">
          <p class="fragment" style="margin-top: 3em; text-align: right; color: #fff; font-size: 3em; font-weight: bold; line-height: 1.6">*applause*</p>
        </section>

        <section>
          <h2>What else?<h2>
        </section>

        <section>
          <h2>Running partial suites</h2>
          <pre class="fragment" style="font-size: 0.7em; margin-top: 2em;"><code>exports.config = {
  seleniumAddress: 'http://localhost:4444/hub',
  capabilities: {
    'browserName': 'chrome'
  },

  suites: {
    app: 'src/app/*.spec.js',
    search: 'src/app/search/*.spec.js'
  }
};</code></pre>
          <pre class="fragment" style="font-size: 0.7em; margin-top: 1.5em;"><code>$ protractor conf.js --suite search</code></pre>
        </section>

        <section>
          <h2>Multicapabilities</h2>
          <div class="fragment">
            <pre style="font-size: 0.7em; margin-top: 2em;"><code>exports.config = {
  seleniumAddress: 'http://localhost:4444/hub',
  multiCapabilities: [
    {
      'browserName': 'chrome'
    },
    {
      'browserName': 'firefox'
    }
  ]
  ...
};</code></pre>
            <p style="margin-top: 1em;">Read more about browser setup <a href="https://github.com/angular/protractor/blob/master/docs/browser-setup.md">here</a>!</p>
        </div>
        </section>

        <section>
          <p>Hey, that's cool. But I don't have all these browsers on my local machine.</p>
        </section>
        <section>
          <section>
            <h2>Running E2E tests on a remote server</h2>
          </section>
          <section>
            <h2><img style="width: 400px;"src="img/sauce-labs-logo.png"></h2>
            <ul>
              <li class="fragment">Testing made awesome</li>
              <li class="fragment">Browser & OS Platforms</li>
              <li class="fragment">No VM setup & maintenance</li>
              <li class="fragment">Video & screenshots</li>
              <li class="fragment">Mobile testing</li>
            </ul>
          </section>
          <section>
            <h2>Configuration</h2>
          <pre class="fragment" style="font-size: 0.7em; margin-top: 2em;"><code>exports.config = {
  seleniumAddress: 'http://localhost:4444/hub',
  capabilities: {
    'browserName': 'chrome'
  },

  sauceUser: 'USERNAME',
  sauceKey: 'KEY',

  suites: {
    app: 'src/app/*.spec.js',
    search: 'src/app/search/*.spec.js'
  }
};</code></pre>
          </section>
        </section>
        <section>
          <h2 style="font-size: 3em;">Demo</h2>
        </section>
        <section>
          <h2>What to expect in the future?</h2>
          <p>V.1.0.0 is on its way!</p>
          <ul>
            <li class="fragment">Locator for <code>by.options</code> (<a href="https://github.com/angular/protractor/commit/7d9088025c5a1c37428ea3f1cee3dc8d3793f79e">7d9088</a>)</li>
            <li class="fragment"><code>ElementArrayFinder.filter</code> <br> <code>ElementArrayFinder.reduce</code> <br> (<a href="https://github.com/angular/protractor/commit/c892c2a1a773cc24cc6565efe2db892776143104">c892c2</a>)</li>
            <li class="fragment">...</li>
          </ul>
        </section>

        <section data-background="img/thumbs-up.gif">
          <div class="fragment">
          <h1 style="color: #fff;">Thank you!</h1>

          <p style="font-size: 0.8em; text-align: left; margin-top: 8em;"><a style="color: #fff;"href="http://twitter.com/PascalPrecht">@PascalPrecht</a></p>
          <p style="font-size: 0.8em; text-align: left;"><a style="color: #fff;"href="https://plus.google.com/u/0/+PascalPrecht/posts">+PascalPrecht</a></p>
          <p style="font-size: 0.8em; text-align: left;"><a style="color: #fff;"href="http://github.com/PascalPrecht">github.com/PascalPrecht</a></p>
          <p style="font-size: 0.8em; text-align: left;"><a style="color: #fff;"href="http://pascalprecht.github.io/slides/e2e-testing-with-protractor">pascalprecht.github.io/slides/e2e-testing-with-protractor</a></p>
        </div>
        </section>
      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Parallax scrolling
        // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // parallaxBackgroundSize: '2100px 900px',

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });

    </script>

  </body>
</html>
